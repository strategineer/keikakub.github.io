console.log=function(){};const SPLIT_CHARACTER=",";window.addEventListener("load",function(){(performance.navigation.type==performance.navigation.TYPE_RELOAD||tryLoadFromLocationHash())&&ExplorerImp.onDefaultActionActivated!==void 0&&ExplorerImp.onDefaultActionActivated()},!1);function tryLoadFromLocationHash(){if(console.log(`tryLoadFromLocationHash()`),window.location.hash){const e=window.location.hash.substring(1);let t=void 0;return e.includes(SPLIT_CHARACTER)?t=e.split(SPLIT_CHARACTER):t=[e],setDiscovery(t),!1}return!0}window.onhashchange=function(){tryLoadFromLocationHash()},document.body.onkeyup=function(e){(e.keyCode==32||e.keyCode==13)&&ExplorerImp.onDefaultActionActivated!==void 0&&ExplorerImp.onDefaultActionActivated()};function detectClickOnDiscovery(){if(console.log(`detectClickOnDiscovery()`),ExplorerImp.onClickWord===void 0)return;s=window.getSelection();let e=s.getRangeAt(0),t=s.anchorNode;for(;e.toString().indexOf(" ")!=0&&e.toString().indexOf("—")!=0;)try{e.setStart(t,e.startOffset-1)}catch{break}e.setStart(t,e.startOffset+1);do try{e.setEnd(t,e.endOffset+1)}catch{break}while(e.toString().indexOf(" ")==-1&&e.toString().indexOf("—")==-1&&e.toString().trim()!="")const n=e.toString().trim().replace(/^\W/g,"").replace(/\W$/g,"").toLowerCase();ExplorerImp.onClickWord(n)}function getDiscoveries(t){let e=[];for(const n of t)e.push({key:n,discovery:ExplorerImp.map.get(n)});return e}function setDiscovery(e){if(console.log(`setDiscovery(${e})`),e.length>ExplorerImp.count&&(console.log(`limiting length to: ${ExplorerImp.count} from ${e.length}`),e=e.slice(0,ExplorerImp.count)),ExplorerImp.currentKeys!==void 0&&ExplorerImp.currentKeys.length==e.length){let t=!0;for(let n=0;n<ExplorerImp.currentKeys.length;++n)if(ExplorerImp.currentKeys[n]!==e[n]){t=!1;break}if(t){console.log("ERROR: keys not equal");return}}for(const t of e)if(!ExplorerImp.map.has(t)){console.log("ERROR: k not found"),console.log(t);return}ExplorerImp.currentKeys=e,window.location.hash=e.join(SPLIT_CHARACTER);const t=getDiscoveries(e);if(ExplorerImp.onSetDiscovery(t),ExplorerImp.generateShareData!==void 0&&navigator.canShare(ExplorerImp.generateShareData(t))){const e=document.querySelector("#explorer-footer-button-share");e.classList.remove("d-none")}}function setAllDiscovery(){console.log(`setAllDiscovery()`),setDiscovery(ExplorerImp.keys.filter(ExplorerImp.keysFilter))}function setNextDiscovery(){console.log(`setNextDiscovery()`),ExplorerImp.currentIndex===void 0&&(ExplorerImp.currentIndex=pickIndex(ExplorerImp.keys)),console.log(`${ExplorerImp.currentIndex}`);let e=[];for(let n=0;n<ExplorerImp.count;++n){const t=(ExplorerImp.currentIndex+1)%ExplorerImp.keys.length;console.log(`${ExplorerImp.currentIndex} -> ${t}`),ExplorerImp.currentIndex=t;const s=ExplorerImp.keys[t];e.push(s)}setDiscovery(e)}function setRandomDiscovery(){console.log(`setRandomDiscovery()`);let e=[];for(let n=0;n<ExplorerImp.count;++n){let t=void 0,s=0;do t=pickOne(ExplorerImp.keys),++s;while(s<100&&(e.includes(t)||ExplorerImp.currentKeys!==void 0&&ExplorerImp.currentKeys.includes(t)))e.push(t)}setDiscovery(e)}function shareDiscovery(){if(console.log(`shareDiscovery()`),ExplorerImp.generateShareData===void 0)return;const e=ExplorerImp.generateShareData(getDiscoveries(ExplorerImp.currentKeys));if(!navigator.canShare(e))return;try{navigator.share(e)}catch(e){return}}